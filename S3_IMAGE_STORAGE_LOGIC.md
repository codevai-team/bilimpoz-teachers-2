# –õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ S3

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å S3 –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –ø—Ä–æ–µ–∫—Ç–µ.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã](#–æ–±–∑–æ—Ä-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
2. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è S3](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-s3)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ö—Ä–∞–Ω–µ–Ω–∏—è-—Ñ–∞–π–ª–æ–≤)
4. [–ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π](#–ø—Ä–æ—Ü–µ—Å—Å-–∑–∞–≥—Ä—É–∑–∫–∏-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
5. [–í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-—Ñ–∞–π–ª–æ–≤)
6. [–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤](#–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–∏–º–µ–Ω-—Ñ–∞–π–ª–æ–≤)
7. [–£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤](#—É–¥–∞–ª–µ–Ω–∏–µ-—Ñ–∞–π–ª–æ–≤)
8. [API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã](#api-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã)
9. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
10. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)

---

## –û–±–∑–æ—Ä –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Frontend       ‚îÇ
‚îÇ  (React/Next.js)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ FormData
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  API Route      ‚îÇ
‚îÇ  (Next.js API)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ‚ñ∫ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞
         ‚îú‚îÄ‚ñ∫ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏
         ‚îú‚îÄ‚ñ∫ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  S3 Library     ‚îÇ
‚îÇ  (src/lib/s3.ts) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚îú‚îÄ‚ñ∫ –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
         ‚îú‚îÄ‚ñ∫ –°–æ–∑–¥–∞–Ω–∏–µ S3 –∫–ª–∏–µ–Ω—Ç–∞
         ‚îú‚îÄ‚ñ∫ –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  S3 Storage     ‚îÇ
‚îÇ  (AWS/MinIO)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:

1. **–ö–ª–∏–µ–Ω—Ç** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ñ–∞–π–ª —á–µ—Ä–µ–∑ FormData
2. **API Route** –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª
3. **S3 Library** –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –≤ S3
4. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç URL —Ñ–∞–π–ª–∞
5. **–ö–ª–∏–µ–Ω—Ç** –ø–æ–ª—É—á–∞–µ—Ç URL –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è S3

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞):

1. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (—Ç–∞–±–ª–∏—Ü–∞ `settings`)
2. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** (fallback)

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ë–î:

```sql
-- –¢–∞–±–ª–∏—Ü–∞ settings
INSERT INTO settings (key, value) VALUES
  ('S3_URL', 'https://s3.example.com'),
  ('S3_ACCESS_KEY', 'your-access-key'),
  ('S3_SECRET_ACCESS_KEY', 'your-secret-key'),
  ('BUCKET_NAME', 'bilimpoz-storage');
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

```env
# .env
S3_URL=https://s3.example.com
S3_ACCESS_KEY=your-access-key
S3_SECRET_ACCESS_KEY=your-secret-key
BUCKET_NAME=bilimpoz-storage
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```typescript
// –ö—ç—à –Ω–∞—Å—Ç—Ä–æ–µ–∫ S3
let s3ConfigCache: S3Config | null = null;
let s3ConfigCacheTime: number = 0;
const CACHE_TTL = 5 * 60 * 1000; // 5 –º–∏–Ω—É—Ç
```

**–õ–æ–≥–∏–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç
- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ TTL –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ –∏–∑ –ë–î
- –ú–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å –∫—ç—à —á–µ—Ä–µ–∑ `clearS3ConfigCache()`

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```typescript
async function getS3Config(): Promise<S3Config> {
  // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—ç—à–∞
  const now = Date.now();
  if (s3ConfigCache && (now - s3ConfigCacheTime) < CACHE_TTL) {
    return s3ConfigCache;
  }

  // 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î
  const settings = await prisma.settings.findMany({
    where: {
      key: {
        in: ['S3_URL', 'S3_ACCESS_KEY', 'S3_SECRET_ACCESS_KEY', 'BUCKET_NAME']
      }
    }
  });

  // 3. Fallback –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
  const endpoint = configMap['S3_URL'] || process.env.S3_URL;
  const accessKeyId = configMap['S3_ACCESS_KEY'] || process.env.S3_ACCESS_KEY;
  const secretAccessKey = configMap['S3_SECRET_ACCESS_KEY'] || process.env.S3_SECRET_ACCESS_KEY;
  const bucketName = configMap['BUCKET_NAME'] || process.env.BUCKET_NAME;

  // 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞–ª–∏—á–∏—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
  if (!endpoint || !accessKeyId || !secretAccessKey || !bucketName) {
    throw new Error('–ù–µ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ S3 –Ω–∞–π–¥–µ–Ω—ã');
  }

  // 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à
  s3ConfigCache = { endpoint, accessKeyId, secretAccessKey, bucketName };
  s3ConfigCacheTime = now;

  return s3ConfigCache;
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ S3 –∫–ª–∏–µ–Ω—Ç–∞:

```typescript
async function getS3Client(): Promise<S3Client> {
  const config = await getS3Config();
  
  return new S3Client({
    endpoint: config.endpoint,
    region: 'auto', // –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
    credentials: {
      accessKeyId: config.accessKeyId,
      secretAccessKey: config.secretAccessKey,
    },
    forcePathStyle: true, // –î–ª—è MinIO –∏ –¥—Ä—É–≥–∏—Ö S3-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
  });
}
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤

### –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
bilimpoz/
‚îú‚îÄ‚îÄ courses/
‚îÇ   ‚îú‚îÄ‚îÄ images/          # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ videos/           # –í–∏–¥–µ–æ –∫—É—Ä—Å–æ–≤
‚îú‚îÄ‚îÄ lessons/
‚îÇ   ‚îú‚îÄ‚îÄ videos/         # –í–∏–¥–µ–æ —É—Ä–æ–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ lecture-images/ # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–µ–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ lectures/       # –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ª–µ–∫—Ü–∏–∏ (MD)
‚îÇ   ‚îî‚îÄ‚îÄ lesson-test-images/ # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ —É—Ä–æ–∫–æ–≤
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îî‚îÄ‚îÄ profile-photos/  # –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ teachers/
‚îÇ   ‚îú‚îÄ‚îÄ teacher_profile_photos/ # –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª–µ–π —É—á–∏—Ç–µ–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ question_pictures/     # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤
‚îú‚îÄ‚îÄ newsletters/
‚îÇ   ‚îî‚îÄ‚îÄ images/         # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞—Å—Å—ã–ª–æ–∫
‚îî‚îÄ‚îÄ misc/               # –ü—Ä–æ—á–∏–µ —Ñ–∞–π–ª—ã
```

### –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—É—Ç–∏:

```typescript
export function getS3Path(
  type: 'course-images' | 'course-videos' | 
       'lesson-videos' | 'lesson-images' | 
       'lesson-documents' | 'lesson-lectures' | 
       'lesson-test-images' | 'profile-photos' | 
       'newsletter-images' | 'teacher-profile-photos' | 
       'question-pictures'
): string {
  const basePath = 'bilimpoz';
  
  switch (type) {
    case 'course-images':
      return `${basePath}/courses/images`;
    case 'course-videos':
      return `${basePath}/courses/videos`;
    case 'lesson-videos':
      return `${basePath}/lessons/videos`;
    case 'lesson-images':
      return `${basePath}/lessons/lecture-images`;
    case 'lesson-documents':
      return `${basePath}/lessons/lecture-images`;
    case 'lesson-lectures':
      return `${basePath}/lessons/lectures`;
    case 'lesson-test-images':
      return `${basePath}/lessons/lesson-test-images`;
    case 'profile-photos':
      return `${basePath}/users/profile-photos`;
    case 'newsletter-images':
      return `${basePath}/newsletters/images`;
    case 'teacher-profile-photos':
      return `${basePath}/teachers/teacher_profile_photos`;
    case 'question-pictures':
      return `${basePath}/teachers/question_pictures`;
    default:
      return `${basePath}/misc`;
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã –ø—É—Ç–µ–π:

| –¢–∏–ø —Ñ–∞–π–ª–∞ | –ü—É—Ç—å –≤ S3 |
|-----------|-----------|
| –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É—á–∏—Ç–µ–ª—è | `bilimpoz/teachers/teacher_profile_photos/1234567890-abc123.jpg` |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞ | `bilimpoz/teachers/question_pictures/1234567890-xyz789.png` |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞ | `bilimpoz/courses/images/1234567890-course.jpg` |
| –í–∏–¥–µ–æ —É—Ä–æ–∫–∞ | `bilimpoz/lessons/videos/1234567890-lesson.mp4` |

---

## –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞

```typescript
// API Route
const formData = await request.formData();
const file = formData.get('file') as File;

if (!file) {
  return NextResponse.json(
    { success: false, message: '–§–∞–π–ª –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω' },
    { status: 400 }
  );
}
```

### –®–∞–≥ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞

```typescript
// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞
const validation = validateFile(
  { size: file.size, mimetype: file.type },
  'image'
);

if (!validation.isValid) {
  return NextResponse.json(
    { success: false, message: validation.error },
    { status: 400 }
  );
}
```

### –®–∞–≥ 3: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

```typescript
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏
const fileName = generateFileName(file.name, 'profile');
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "1234567890-abc123def456.jpg"
```

### –®–∞–≥ 4: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer

```typescript
// –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è File –≤ Buffer
const arrayBuffer = await file.arrayBuffer();
const buffer = Buffer.from(arrayBuffer);
```

### –®–∞–≥ 5: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –≤ S3

```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—É—Ç–∏ –¥–ª—è —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
const s3Path = getS3Path('teacher-profile-photos');
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "bilimpoz/teachers/teacher_profile_photos"
```

### –®–∞–≥ 6: –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3

```typescript
// –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ S3
const fileUrl = await uploadFileToS3(
  buffer,           // Buffer —Å –¥–∞–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞
  fileName,         // –ò–º—è —Ñ–∞–π–ª–∞
  file.type,        // Content-Type (image/jpeg, image/png, etc.)
  s3Path           // –ü—É—Ç—å –≤ S3
);
```

### –®–∞–≥ 7: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URL –≤ –ë–î

```typescript
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î
await prisma.users.update({
  where: { id: user.id },
  data: {
    profile_photo_url: fileUrl,
    updated_at: new Date()
  }
});
```

### –®–∞–≥ 8: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```typescript
// –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ S3
if (currentUser?.profile_photo_url) {
  try {
    await deleteFileFromS3(currentUser.profile_photo_url);
  } catch (error) {
    // –õ–æ–≥–∏—Ä—É–µ–º, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä–æ–µ —Ñ–æ—Ç–æ:', error);
  }
}
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏:

```typescript
export async function uploadFileToS3(
  file: Buffer,
  fileName: string,
  contentType: string,
  s3Path: string
): Promise<string> {
  // 1. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏
  const normalizedPath = s3Path.replace(/\/+/g, '/');
  const normalizedFileName = fileName.replace(/^\/+/, '');
  const key = `${normalizedPath}/${normalizedFileName}`.replace(/\/+/g, '/');
  
  // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ S3 –∫–ª–∏–µ–Ω—Ç–∞ –∏ bucket
  const s3Client = await getS3Client();
  const bucketName = await getBucketName();
  
  // 3. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏
  const command = new PutObjectCommand({
    Bucket: bucketName,
    Key: key,
    Body: file,
    ContentType: contentType,
    ACL: 'public-read', // –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –¥–ª—è —á—Ç–µ–Ω–∏—è
  });

  // 4. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
  await s3Client.send(command);
  
  // 5. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL
  const s3Url = await getS3Url();
  return `${s3Url}/${bucketName}/${key}`;
}
```

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤

### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã:

```typescript
// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
export const ALLOWED_IMAGE_TYPES = [
  'image/jpeg',
  'image/png',
  'image/webp'
];

// –í–∏–¥–µ–æ
export const ALLOWED_VIDEO_TYPES = [
  'video/mp4',
  'video/webm',
  'video/ogg'
];

// –í—Å–µ —Ç–∏–ø—ã
export const ALLOWED_FILE_TYPES = [
  ...ALLOWED_IMAGE_TYPES,
  ...ALLOWED_VIDEO_TYPES
];
```

### –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã:

```typescript
// –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 10MB
export const MAX_IMAGE_SIZE = 10 * 1024 * 1024;

// –í–∏–¥–µ–æ: 100MB
export const MAX_VIDEO_SIZE = 100 * 1024 * 1024;
```

### –§—É–Ω–∫—Ü–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```typescript
export function validateFile(
  file: { size: number; mimetype: string },
  type: 'image' | 'video'
): { isValid: boolean; error?: string } {
  const allowedTypes = type === 'image' 
    ? ALLOWED_IMAGE_TYPES 
    : ALLOWED_VIDEO_TYPES;
  const maxSize = type === 'image' 
    ? MAX_IMAGE_SIZE 
    : MAX_VIDEO_SIZE;

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ —Ñ–∞–π–ª–∞
  if (!allowedTypes.includes(file.mimetype)) {
    return {
      isValid: false,
      error: `–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞. –†–∞–∑—Ä–µ—à–µ–Ω—ã: ${allowedTypes.join(', ')}`
    };
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
  if (file.size > maxSize) {
    const maxSizeMB = Math.round(maxSize / (1024 * 1024));
    return {
      isValid: false,
      error: `–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: ${maxSizeMB}MB`
    };
  }

  return { isValid: true };
}
```

### –ü—Ä–∏–º–µ—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

```typescript
// ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π —Ñ–∞–π–ª
validateFile(
  { size: 5 * 1024 * 1024, mimetype: 'image/jpeg' },
  'image'
);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: { isValid: true }

// ‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ç–∏–ø
validateFile(
  { size: 5 * 1024 * 1024, mimetype: 'image/gif' },
  'image'
);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: { isValid: false, error: '–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞...' }

// ‚ùå –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
validateFile(
  { size: 15 * 1024 * 1024, mimetype: 'image/jpeg' },
  'image'
);
// –†–µ–∑—É–ª—å—Ç–∞—Ç: { isValid: false, error: '–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 10MB' }
```

---

## –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤

### –ê–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:

```typescript
export function generateFileName(
  originalName: string,
  prefix: string = ''
): string {
  // 1. –¢–∞–π–º—Å—Ç–∞–º–ø (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã)
  const timestamp = Date.now();
  
  // 2. –°–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ (base36)
  const randomString = Math.random()
    .toString(36)
    .substring(2, 15);
  
  // 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏–∑ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏
  const extension = originalName.split('.').pop();
  
  // 4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–Ω–∏
  return `${timestamp}-${randomString}.${extension}`;
}
```

### –ü—Ä–∏–º–µ—Ä—ã:

| –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|------------------|-----------|
| `photo.jpg` | `1234567890-abc123def456.jpg` |
| `image.png` | `1234567891-xyz789ghi012.png` |
| `avatar.webp` | `1234567892-mno345pqr678.webp` |

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –ö–æ–º–±–∏–Ω–∞—Ü–∏—è timestamp + random –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
2. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**: Timestamp –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
4. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –õ–µ–≥–∫–æ –ø–∞—Ä—Å–∏—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å

---

## –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### –ü—Ä–æ—Ü–µ—Å—Å —É–¥–∞–ª–µ–Ω–∏—è:

```typescript
export async function deleteFileFromS3(fileUrl: string): Promise<void> {
  try {
    // 1. –ü–æ–ª—É—á–µ–Ω–∏–µ S3 –∫–ª–∏–µ–Ω—Ç–∞ –∏ bucket
    const s3Client = await getS3Client();
    const bucketName = await getBucketName();
    
    // 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ URL
    const urlParts = fileUrl.split('/');
    const bucketIndex = urlParts.indexOf(bucketName);
    
    if (bucketIndex === -1) {
      throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π URL —Ñ–∞–π–ª–∞');
    }
    
    // 3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–∞
    const key = urlParts.slice(bucketIndex + 1).join('/');
    
    // 4. –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —ç—Ç–æ —Ñ–∞–π–ª, –∞ –Ω–µ –ø–∞–ø–∫–∞
    if (key.endsWith('/') || !key.includes('.')) {
      throw new Error('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É, —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã');
    }
    
    // 5. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã —É–¥–∞–ª–µ–Ω–∏—è
    const command = new DeleteObjectCommand({
      Bucket: bucketName,
      Key: key,
    });

    // 6. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
    await s3Client.send(command);
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–∑ S3:', error);
    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª');
  }
}
```

### –ü—Ä–∏–º–µ—Ä—ã URL:

| URL | –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –∫–ª—é—á |
|-----|------------------|
| `https://s3.example.com/bucket/bilimpoz/teachers/photo.jpg` | `bilimpoz/teachers/photo.jpg` |
| `https://s3.example.com/bucket/bilimpoz/users/profile.jpg` | `bilimpoz/users/profile.jpg` |

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:

```typescript
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
try {
  await deleteFileFromS3(oldFileUrl);
  console.log('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
} catch (error) {
  // –õ–æ–≥–∏—Ä—É–µ–º, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
  console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª:', error);
  // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
}
```

---

## API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /api/auth/upload-profile-photo`

**–ó–∞–ø—Ä–æ—Å:**
```typescript
const formData = new FormData();
formData.append('file', file);

const response = await fetch('/api/auth/upload-profile-photo', {
  method: 'POST',
  body: formData,
  credentials: 'include'
});
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "url": "https://s3.example.com/bucket/bilimpoz/teachers/teacher_profile_photos/1234567890-abc123.jpg",
  "message": "–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞ (—Ç–∏–ø, —Ä–∞–∑–º–µ—Ä)
3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
5. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ URL –≤ –ë–î
7. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ç–æ (–µ—Å–ª–∏ –µ—Å—Ç—å)

### 2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /api/teacher/upload/question-image`

**–ó–∞–ø—Ä–æ—Å:**
```typescript
const formData = new FormData();
formData.append('file', file);
formData.append('oldImageUrl', oldUrl); // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ

const response = await fetch('/api/teacher/upload/question-image', {
  method: 'POST',
  body: formData,
  credentials: 'include'
});
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "url": "https://s3.example.com/bucket/bilimpoz/teachers/question_pictures/1234567890-xyz789.png",
  "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–æ–ª–∏ (teacher)
2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–∞
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
5. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–æ)

### 3. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `DELETE /api/teacher/upload/question-image?url={fileUrl}`

**–ó–∞–ø—Ä–æ—Å:**
```typescript
const response = await fetch(
  `/api/teacher/upload/question-image?url=${encodeURIComponent(fileUrl)}`,
  {
    method: 'DELETE',
    credentials: 'include'
  }
);
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "message": "–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–æ"
}
```

### 4. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –∏–∑ Telegram URL

**–≠–Ω–¥–ø–æ–∏–Ω—Ç:** `POST /api/teacher/upload/profile-photo`

**–ó–∞–ø—Ä–æ—Å:**
```json
{
  "telegramPhotoUrl": "https://api.telegram.org/file/bot...",
  "userId": "user_123"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "url": "https://s3.example.com/bucket/bilimpoz/teachers/teacher_profile_photos/1234567890-abc123.jpg",
  "message": "–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ S3"
}
```

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ —Ä–æ–ª–∏
2. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Telegram
3. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
5. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è (Frontend)

```typescript
// –ö–æ–º–ø–æ–Ω–µ–Ω—Ç React
const handlePhotoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {
  const file = e.target.files?.[0];
  if (!file) return;

  // –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
  if (!file.type.startsWith('image/')) {
    showError('–†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
    return;
  }

  if (file.size > 10 * 1024 * 1024) {
    showError('–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–≤—ã—à–∞—Ç—å 10MB');
    return;
  }

  setUploadingPhoto(true);

  try {
    const formData = new FormData();
    formData.append('file', file);

    const response = await fetch('/api/auth/upload-profile-photo', {
      method: 'POST',
      body: formData,
      credentials: 'include',
    });

    const result = await response.json();

    if (result.success) {
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ñ–æ—Ç–æ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏
      setUser(prev => prev ? { 
        ...prev, 
        profilePhoto: result.url 
      } : null);
      showSuccess('–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ');
    } else {
      showError(result.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ');
    }
  } catch (error) {
    console.error('Photo upload error:', error);
    showError('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ');
  } finally {
    setUploadingPhoto(false);
  }
};
```

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞ (API Route)

```typescript
// src/app/api/teacher/upload/question-image/route.ts
export async function POST(request: NextRequest) {
  try {
    // 1. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    const user = await auth(request);
    if (!user || user.role !== 'teacher') {
      return NextResponse.json(
        { success: false, message: '–î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è —É—á–∏—Ç–µ–ª–µ–π' },
        { status: 403 }
      );
    }

    // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
    const formData = await request.formData();
    const file = formData.get('file') as File;
    const oldImageUrl = formData.get('oldImageUrl') as string | null;

    if (!file) {
      return NextResponse.json(
        { success: false, message: '–§–∞–π–ª –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω' },
        { status: 400 }
      );
    }

    // 3. –í–∞–ª–∏–¥–∞—Ü–∏—è
    const validation = validateFile(
      { size: file.size, mimetype: file.type },
      'image'
    );

    if (!validation.isValid) {
      return NextResponse.json(
        { success: false, message: validation.error },
        { status: 400 }
      );
    }

    // 4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ –∏ –ø—É—Ç–∏
    const fileName = generateFileName(file.name, 'question');
    const s3Path = getS3Path('question-pictures');

    // 5. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer
    const bytes = await file.arrayBuffer();
    const buffer = Buffer.from(bytes);

    // 6. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
    const fileUrl = await uploadFileToS3(
      buffer,
      fileName,
      file.type,
      s3Path
    );

    // 7. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    if (oldImageUrl && oldImageUrl.trim() && oldImageUrl !== fileUrl) {
      try {
        await deleteFileFromS3(oldImageUrl);
      } catch (error) {
        console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ:', error);
      }
    }

    return NextResponse.json({
      success: true,
      url: fileUrl,
      message: '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ'
    });

  } catch (error) {
    console.error('Upload question image error:', error);
    return NextResponse.json(
      { success: false, message: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è' },
      { status: 500 }
    );
  }
}
```

### –ü—Ä–∏–º–µ—Ä 3: –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ URL

```typescript
// –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ Telegram –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –≤ S3
export async function downloadAndUploadToS3(
  imageUrl: string,
  fileName: string,
  s3Path: string,
  contentType: string = 'image/jpeg'
): Promise<string> {
  try {
    // 1. –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    const response = await fetch(imageUrl);
    if (!response.ok) {
      throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ: ${response.statusText}`);
    }

    // 2. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer
    const arrayBuffer = await response.arrayBuffer();
    const buffer = Buffer.from(arrayBuffer);

    // 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ content-type
    const responseContentType = response.headers.get('content-type') || contentType;

    // 4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
    const fileUrl = await uploadFileToS3(
      buffer,
      fileName,
      responseContentType,
      s3Path
    );

    return fileUrl;
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ S3:', error);
    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–∞—á–∞—Ç—å –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ S3');
  }
}
```

---

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø—ã –æ—à–∏–±–æ–∫:

1. **–û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
   - –ù–µ –Ω–∞–π–¥–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ S3 –≤ –ë–î –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫

2. **–û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
   - –ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ç–∏–ø —Ñ–∞–π–ª–∞
   - –ü—Ä–µ–≤—ã—à–µ–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä

3. **–û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏:**
   - –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ S3
   - –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ —Ñ–∞–π–ª–∞
   - –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

4. **–û—à–∏–±–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è:**
   - –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω
   - –ù–µ–≤–µ—Ä–Ω—ã–π URL —Ñ–∞–π–ª–∞
   - –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ API Route:

```typescript
try {
  // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞
  const fileUrl = await uploadFileToS3(...);
  
  return NextResponse.json({
    success: true,
    url: fileUrl
  });
} catch (error) {
  console.error('Upload error:', error);
  
  // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏
  if (error instanceof Error) {
    if (error.message.includes('–Ω–∞—Å—Ç—Ä–æ–π–∫–∏')) {
      return NextResponse.json(
        { success: false, message: '–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ S3' },
        { status: 500 }
      );
    }
    
    if (error.message.includes('—Ä–∞–∑–º–µ—Ä') || error.message.includes('—Ç–∏–ø')) {
      return NextResponse.json(
        { success: false, message: error.message },
        { status: 400 }
      );
    }
  }
  
  return NextResponse.json(
    { success: false, message: '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞' },
    { status: 500 }
  );
}
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ:

```typescript
// –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
if (oldFileUrl) {
  try {
    await deleteFileFromS3(oldFileUrl);
    console.log('–°—Ç–∞—Ä—ã–π —Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω');
  } catch (error) {
    // –õ–æ–≥–∏—Ä—É–µ–º, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
    console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª:', error);
    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ - –Ω–æ–≤—ã–π —Ñ–∞–π–ª —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω
  }
}
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ URL:

```typescript
// –î–ª—è –ø—Ä—è–º–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å –∫–ª–∏–µ–Ω—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
export async function getSignedUploadUrl(
  fileName: string,
  contentType: string,
  s3Path: string
): Promise<string> {
  const key = `${s3Path}/${fileName}`;
  
  const s3Client = await getS3Client();
  const bucketName = await getBucketName();
  
  const command = new PutObjectCommand({
    Bucket: bucketName,
    Key: key,
    ContentType: contentType,
  });

  try {
    // URL –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 1 —á–∞—Å
    const signedUrl = await getSignedUrl(s3Client, command, { 
      expiresIn: 3600 
    });
    return signedUrl;
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ URL:', error);
    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π URL');
  }
}
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:

```typescript
// –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–µ–∫—Ü–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown
export async function uploadTextToS3(
  content: string,
  format: 'md' | 'txt',
  lessonId: string,
  oldLectureUrl?: string
): Promise<string> {
  // –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–∞–π–ª–∞
  if (oldLectureUrl && oldLectureUrl.trim()) {
    try {
      await deleteFileFromS3(oldLectureUrl);
    } catch (error) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –ª–µ–∫—Ü–∏–∏:', error);
    }
  }

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
  const timestamp = Date.now();
  const randomString = Math.random().toString(36).substring(2, 15);
  const fileName = `lecture-${lessonId}-${timestamp}-${randomString}.md`;
  const s3Path = getS3Path('lesson-lectures');
  const key = `${s3Path}/${fileName}`;
  
  // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ Buffer
  const contentType = 'text/markdown';
  const buffer = Buffer.from(content, 'utf-8');
  
  // –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
  const s3Client = await getS3Client();
  const bucketName = await getBucketName();
  
  const command = new PutObjectCommand({
    Bucket: bucketName,
    Key: key,
    Body: buffer,
    ContentType: contentType,
    ACL: 'public-read',
  });

  await s3Client.send(command);
  
  // –í–æ–∑–≤—Ä–∞—Ç –ø—É–±–ª–∏—á–Ω–æ–≥–æ URL
  const s3Url = await getS3Url();
  return `${s3Url}/${bucketName}/${key}`;
}
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ:

‚úÖ **–í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
if (!file.type.startsWith('image/')) {
  return;
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞
if (file.size > 10 * 1024 * 1024) {
  return;
}
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

‚úÖ **–í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
```typescript
const validation = validateFile(
  { size: file.size, mimetype: file.type },
  'image'
);

if (!validation.isValid) {
  return NextResponse.json(
    { success: false, message: validation.error },
    { status: 400 }
  );
}
```

### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:

‚úÖ **–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏ gracefully:**
```typescript
try {
  await deleteFileFromS3(oldFileUrl);
} catch (error) {
  // –õ–æ–≥–∏—Ä—É–µ–º, –Ω–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å
  console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª:', error);
}
```

### 4. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞:

‚úÖ **–û—á–∏—â–∞–π—Ç–µ –∫—ç—à –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫:**
```typescript
// –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ S3 –≤ –ë–î
clearS3ConfigCache();
```

### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

‚úÖ **–õ–æ–≥–∏—Ä—É–π—Ç–µ –≤–∞–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:**
```typescript
console.log('–§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω:', fileUrl);
console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª:', error);
console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ –≤ S3:', error);
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ URL —Ñ–∞–π–ª–æ–≤

### –§–æ—Ä–º–∞—Ç URL:

```
{S3_URL}/{BUCKET_NAME}/{S3_PATH}/{FILE_NAME}
```

### –ü—Ä–∏–º–µ—Ä—ã:

```
https://s3.example.com/bilimpoz-storage/bilimpoz/teachers/teacher_profile_photos/1234567890-abc123.jpg
```

**–†–∞–∑–±–æ—Ä URL:**
- `S3_URL`: `https://s3.example.com`
- `BUCKET_NAME`: `bilimpoz-storage`
- `S3_PATH`: `bilimpoz/teachers/teacher_profile_photos`
- `FILE_NAME`: `1234567890-abc123.jpg`

### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª—é—á–∞ –∏–∑ URL:

```typescript
// –î–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
const urlParts = fileUrl.split('/');
const bucketIndex = urlParts.indexOf(bucketName);
const key = urlParts.slice(bucketIndex + 1).join('/');
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "bilimpoz/teachers/teacher_profile_photos/1234567890-abc123.jpg"
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø:

```typescript
// –§–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å ACL: 'public-read'
// –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø—Ä—è–º–æ–º—É URL
ACL: 'public-read'
```

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–∏–ø–æ–≤:

‚úÖ **–†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–∏–ø—ã:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: JPEG, PNG, WebP
- –í–∏–¥–µ–æ: MP4, WebM, OGG

### 3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞:

‚úÖ **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã:**
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 10MB
- –í–∏–¥–µ–æ: 100MB

### 4. –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞:

‚úÖ **–ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É–∫–∞–∑–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∏–º—è
- –ò—Å–∫–ª—é—á–∞–µ—Ç path traversal –∞—Ç–∞–∫–∏

### 5. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:

‚úÖ **–í—Å–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
```typescript
const user = await auth(request);
if (!user) {
  return NextResponse.json(
    { success: false, message: '–ù–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è' },
    { status: 401 }
  );
}
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ S3 –≤–∫–ª—é—á–∞–µ—Ç:

1. **–ì–∏–±–∫—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ –ë–î –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–í–∞–ª–∏–¥–∞—Ü–∏—é** - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –∏ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤
4. **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞** - –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤
5. **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞
6. **–û–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫** - graceful handling –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
7. **–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-01-16  
**–í–µ—Ä—Å–∏—è:** 1.0

